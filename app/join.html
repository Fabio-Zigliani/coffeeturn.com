<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <script>navigator.serviceWorker.register("js/pwabuilder-sw.js")</script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="/manifest.json">
</head>
<title>coffeeturn.com - so you know who's turn it is to pay for coffee.</title>

<body>
    <!-- <link rel="stylesheet" href="/css/milligram.css"> -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="manifest" href="manifest.json" />
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark" aria-label="Eighth navbar example">
        <div class="container">
            <a class="navbar-brand" href="https://coffeeturn.com/">CoffeeTurn.com</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample07"
                aria-controls="navbarsExample07" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarsExample07">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link disabled">Join</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="about.html">About</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <header>
        <div class="px-4 py-5 my-5 text-center"><img alt="CoffeeTurn logo" src="/images/logo.png"><br>
            <h1>coffeeturn.com</h1>
            So you know who's turn it is to pay for coffee.
        </div>>
    </header><br>
    <!--  -->
    <div class="px-4 py-5 my-5 text-center">
        <h2>Join CoffeTurn.com</h2>
        <h3>
            Click below to send us an sms to Join
        </h3>
        You will receive an sms back and will be able to enter the code below to confirm
        <form action="/api/enrol" method="post" id="enrolform">
            <fieldset>
                <label for="nameField">Send me a Registration Code</label><br>
                <input type="text" placeholder="enter your mobile number like +64 21 999999" id="mobile" name="mobile"><br>
                <input class="btn btn-primary btn-lg px-4" type="submit" value="Send">
            </fieldset>
        </form>
    </div>
    <br>
    <!-- <section>
        <a class="button button-outline" href="index.html">Home</a>
        <a class="button button-clear" href="about.html">About</a>
    </section> -->
    <script type="module">
        // Check that service workers are supported
        import 'https://cdn.jsdelivr.net/npm/@pwabuilder/pwaupdate';
        const el = document.createElement('pwa-update');
        document.body.appendChild(el);
    </script>
    <script>
        document.addEventListener("submit", function (event) {
            const form = event.target;
            var payload = {};
            document.querySelector('input[id="mobile"]')
                .forEach(function (element) { payload[element.id] = element.value });
            fetch(form.action, { method: form.method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) })
                .then(function (response) {
                    if (response.ok) {
                        form.reset();
                    }
                })
                .catch(function (error) {
                    console.warn(error);
                });
            //redirect to Index to enter received code
            window.location.href = "http://coffeeturn.com/index.html";
        });
        function onSubmit(token) {
            document.getElementById("enrolform").submit();
        }
    </script>
</body>

</html>